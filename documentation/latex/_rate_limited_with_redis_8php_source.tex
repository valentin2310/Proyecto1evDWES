\doxysection{Rate\+Limited\+With\+Redis.\+php}
\hypertarget{_rate_limited_with_redis_8php_source}{}\label{_rate_limited_with_redis_8php_source}\index{vendor/laravel/framework/src/Illuminate/Queue/Middleware/RateLimitedWithRedis.php@{vendor/laravel/framework/src/Illuminate/Queue/Middleware/RateLimitedWithRedis.php}}
\mbox{\hyperlink{_rate_limited_with_redis_8php}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00001}00001\ <?php}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00003}00003\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_illuminate_1_1_queue_1_1_middleware}{Illuminate\(\backslash\)Queue\(\backslash\)Middleware}};}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00004}00004\ }
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00005}00005\ use\ \mbox{\hyperlink{class_illuminate_1_1_container_1_1_container}{Illuminate\(\backslash\)Container\(\backslash\)Container}};}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00006}00006\ use\ \mbox{\hyperlink{interface_illuminate_1_1_contracts_1_1_redis_1_1_factory}{Illuminate\(\backslash\)Contracts\(\backslash\)Redis\(\backslash\)Factory}}\ as\ Redis;}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00007}00007\ use\ \mbox{\hyperlink{class_illuminate_1_1_redis_1_1_limiters_1_1_duration_limiter}{Illuminate\(\backslash\)Redis\(\backslash\)Limiters\(\backslash\)DurationLimiter}};}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00008}00008\ use\ Illuminate\(\backslash\)Support\(\backslash\)InteractsWithTime;}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00010}\mbox{\hyperlink{class_illuminate_1_1_queue_1_1_middleware_1_1_rate_limited_with_redis}{00010}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_illuminate_1_1_queue_1_1_middleware_1_1_rate_limited_with_redis}{RateLimitedWithRedis}}\ \textcolor{keyword}{extends}\ \mbox{\hyperlink{class_illuminate_1_1_queue_1_1_middleware_1_1_rate_limited}{RateLimited}}}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00011}00011\ \{}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00012}00012\ \ \ \ \ use\ InteractsWithTime;}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00013}00013\ }
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00019}\mbox{\hyperlink{class_illuminate_1_1_queue_1_1_middleware_1_1_rate_limited_with_redis_a7e7e7dbbfe52839237c99924e35f2717}{00019}}\ \ \ \ \ \textcolor{keyword}{protected}\ \mbox{\hyperlink{class_illuminate_1_1_queue_1_1_middleware_1_1_rate_limited_with_redis_a7e7e7dbbfe52839237c99924e35f2717}{\$redis}};}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00020}00020\ }
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00026}\mbox{\hyperlink{class_illuminate_1_1_queue_1_1_middleware_1_1_rate_limited_with_redis_aa93747afde4d923202bc5276b3b0819a}{00026}}\ \ \ \ \ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_illuminate_1_1_queue_1_1_middleware_1_1_rate_limited_with_redis_aa93747afde4d923202bc5276b3b0819a}{\$decaysAt}}\ =\ [];}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00027}00027\ }
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00034}\mbox{\hyperlink{class_illuminate_1_1_queue_1_1_middleware_1_1_rate_limited_with_redis_a4d7eb2d140776dd8f80edc24883d2c4c}{00034}}\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{class_illuminate_1_1_queue_1_1_middleware_1_1_rate_limited_with_redis_a4d7eb2d140776dd8f80edc24883d2c4c}{\_\_construct}}(\mbox{\hyperlink{class_illuminate_1_1_queue_1_1_middleware_1_1_rate_limited_a6dd4eb3237db9c9d4ea4bcaa1b803c68}{\$limiterName}})}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00035}00035\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00036}00036\ \ \ \ \ \ \ \ \ parent::\_\_construct(\mbox{\hyperlink{class_illuminate_1_1_queue_1_1_middleware_1_1_rate_limited_a6dd4eb3237db9c9d4ea4bcaa1b803c68}{\$limiterName}});}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00037}00037\ }
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00038}00038\ \ \ \ \ \ \ \ \ \$this-\/>redis\ =\ Container::getInstance()-\/>make(Redis::class);}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00039}00039\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00040}00040\ }
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00049}\mbox{\hyperlink{class_illuminate_1_1_queue_1_1_middleware_1_1_rate_limited_with_redis_a71f7266d387e66cf1079560d37a786f1}{00049}}\ \ \ \ \ \textcolor{keyword}{protected}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{class_illuminate_1_1_queue_1_1_middleware_1_1_rate_limited_with_redis_a71f7266d387e66cf1079560d37a786f1}{handleJob}}(\mbox{\hyperlink{namespace_illuminate_1_1_queue_aab0e16ecbc63a8e57fdd9823b66be5a1}{\$job}},\ \$next,\ array\ \$limits)}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00050}00050\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00051}00051\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (\$limits\ as\ \$limit)\ \{}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00052}00052\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$this-\/>\mbox{\hyperlink{class_illuminate_1_1_queue_1_1_middleware_1_1_rate_limited_with_redis_a34f29e466a2fe7f79d6033b50862694d}{tooManyAttempts}}(\$limit-\/>key,\ \$limit-\/>maxAttempts,\ \$limit-\/>decayMinutes))\ \{}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00053}00053\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>shouldRelease}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00054}00054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ?\ \mbox{\hyperlink{namespace_illuminate_1_1_queue_aab0e16ecbc63a8e57fdd9823b66be5a1}{\$job}}-\/>release(\$this-\/>\mbox{\hyperlink{class_illuminate_1_1_queue_1_1_middleware_1_1_rate_limited_with_redis_a521cf3acb83696c61229d299011613b6}{getTimeUntilNextRetry}}(\$limit-\/>key))}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00055}00055\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00056}00056\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00057}00057\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00058}00058\ }
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00059}00059\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$next(\mbox{\hyperlink{namespace_illuminate_1_1_queue_aab0e16ecbc63a8e57fdd9823b66be5a1}{\$job}});}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00060}00060\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00061}00061\ }
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00070}\mbox{\hyperlink{class_illuminate_1_1_queue_1_1_middleware_1_1_rate_limited_with_redis_a34f29e466a2fe7f79d6033b50862694d}{00070}}\ \ \ \ \ \textcolor{keyword}{protected}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{class_illuminate_1_1_queue_1_1_middleware_1_1_rate_limited_with_redis_a34f29e466a2fe7f79d6033b50862694d}{tooManyAttempts}}(\$key,\ \$maxAttempts,\ \$decayMinutes)}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00071}00071\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00072}00072\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_illuminate_1_1_queue_1_1_middleware_1_1_rate_limited_abd2697ebde6cb6a4f4da215841eff521}{\$limiter}}\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_illuminate_1_1_redis_1_1_limiters_1_1_duration_limiter}{DurationLimiter}}(}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00073}00073\ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>redis,\ \$key,\ \$maxAttempts,\ \$decayMinutes\ *\ 60}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00074}00074\ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00075}00075\ }
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00076}00076\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ tap(!\ \mbox{\hyperlink{class_illuminate_1_1_queue_1_1_middleware_1_1_rate_limited_abd2697ebde6cb6a4f4da215841eff521}{\$limiter}}-\/>acquire(),\ \mbox{\hyperlink{rector-migrate_8php_affc7ca71e2c30ccc9604c2697809c870}{function}}\ ()\ use\ (\$key,\ \mbox{\hyperlink{class_illuminate_1_1_queue_1_1_middleware_1_1_rate_limited_abd2697ebde6cb6a4f4da215841eff521}{\$limiter}})\ \{}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00077}00077\ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>decaysAt[\$key]\ =\ \mbox{\hyperlink{class_illuminate_1_1_queue_1_1_middleware_1_1_rate_limited_abd2697ebde6cb6a4f4da215841eff521}{\$limiter}}-\/>decaysAt;}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00078}00078\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00079}00079\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00080}00080\ }
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00087}\mbox{\hyperlink{class_illuminate_1_1_queue_1_1_middleware_1_1_rate_limited_with_redis_a521cf3acb83696c61229d299011613b6}{00087}}\ \ \ \ \ \textcolor{keyword}{protected}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{class_illuminate_1_1_queue_1_1_middleware_1_1_rate_limited_with_redis_a521cf3acb83696c61229d299011613b6}{getTimeUntilNextRetry}}(\$key)}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00088}00088\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00089}00089\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\$this-\/>decaysAt[\$key]\ -\/\ \$this-\/>currentTime())\ +\ 3;}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00090}00090\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00091}00091\ }
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00097}\mbox{\hyperlink{class_illuminate_1_1_queue_1_1_middleware_1_1_rate_limited_with_redis_a19dd44fe063cfd1cbafe97452e57666c}{00097}}\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{class_illuminate_1_1_queue_1_1_middleware_1_1_rate_limited_with_redis_a19dd44fe063cfd1cbafe97452e57666c}{\_\_wakeup}}()}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00098}00098\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00099}00099\ \ \ \ \ \ \ \ \ parent::\_\_wakeup();}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00100}00100\ }
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00101}00101\ \ \ \ \ \ \ \ \ \$this-\/>redis\ =\ Container::getInstance()-\/>make(Redis::class);}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00102}00102\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_rate_limited_with_redis_8php_source_l00103}00103\ \}}

\end{DoxyCode}
