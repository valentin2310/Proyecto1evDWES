\doxysection{rebuild\+Parsers.\+php}
\hypertarget{rebuild_parsers_8php_source}{}\label{rebuild_parsers_8php_source}\index{vendor/nikic/php-\/parser/grammar/rebuildParsers.php@{vendor/nikic/php-\/parser/grammar/rebuildParsers.php}}
\mbox{\hyperlink{rebuild_parsers_8php}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00001}00001\ <?php}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00003}00003\ require\ \_\_DIR\_\_\ .\ \textcolor{stringliteral}{'/phpyLang.php'};}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00004}00004\ }
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00005}\mbox{\hyperlink{rebuild_parsers_8php_a722f84b3733683c283f6e88bbffa7a5f}{00005}}\ \mbox{\hyperlink{rebuild_parsers_8php_a722f84b3733683c283f6e88bbffa7a5f}{\$grammarFileToName}}\ =\ [}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00006}00006\ \ \ \ \ \_\_DIR\_\_\ .\ \textcolor{stringliteral}{'/php5.y'}\ =>\ \textcolor{stringliteral}{'Php5'},}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00007}00007\ \ \ \ \ \_\_DIR\_\_\ .\ \textcolor{stringliteral}{'/php7.y'}\ =>\ \textcolor{stringliteral}{'Php7'},}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00008}00008\ ];}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00010}\mbox{\hyperlink{rebuild_parsers_8php_a9fd3574107f4ca3f912c817427e01b22}{00010}}\ \mbox{\hyperlink{rebuild_parsers_8php_a9fd3574107f4ca3f912c817427e01b22}{\$tokensFile}}\ \ \ \ \ =\ \_\_DIR\_\_\ .\ \textcolor{stringliteral}{'/tokens.y'};}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00011}\mbox{\hyperlink{rebuild_parsers_8php_aca7726407aa6397143beb25709572c35}{00011}}\ \mbox{\hyperlink{rebuild_parsers_8php_aca7726407aa6397143beb25709572c35}{\$tokensTemplate}}\ =\ \_\_DIR\_\_\ .\ \textcolor{stringliteral}{'/tokens.template'};}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00012}\mbox{\hyperlink{rebuild_parsers_8php_a1f702d16d6d09d3c3da7219813c565d8}{00012}}\ \mbox{\hyperlink{rebuild_parsers_8php_a1f702d16d6d09d3c3da7219813c565d8}{\$skeletonFile}}\ \ \ =\ \_\_DIR\_\_\ .\ \textcolor{stringliteral}{'/parser.template'};}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00013}\mbox{\hyperlink{rebuild_parsers_8php_a4d8e050e3170aa76e75c3fbf86cd2131}{00013}}\ \mbox{\hyperlink{rebuild_parsers_8php_a4d8e050e3170aa76e75c3fbf86cd2131}{\$tmpGrammarFile}}\ =\ \_\_DIR\_\_\ .\ \textcolor{stringliteral}{'/tmp\_parser.phpy'};}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00014}\mbox{\hyperlink{rebuild_parsers_8php_a5643cdc417b0bbcbeb029aea093166b2}{00014}}\ \mbox{\hyperlink{rebuild_parsers_8php_a5643cdc417b0bbcbeb029aea093166b2}{\$tmpResultFile}}\ \ =\ \_\_DIR\_\_\ .\ \textcolor{stringliteral}{'/tmp\_parser.php'};}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00015}\mbox{\hyperlink{rebuild_parsers_8php_acf9b0a508729b11f65093e54c25c62aa}{00015}}\ \mbox{\hyperlink{rebuild_parsers_8php_acf9b0a508729b11f65093e54c25c62aa}{\$resultDir}}\ =\ \_\_DIR\_\_\ .\ \textcolor{stringliteral}{'/../lib/PhpParser/Parser'};}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00016}\mbox{\hyperlink{rebuild_parsers_8php_a992c9e92e53a2c77e09c899dc1293f29}{00016}}\ \mbox{\hyperlink{rebuild_parsers_8php_a992c9e92e53a2c77e09c899dc1293f29}{\$tokensResultsFile}}\ =\ \mbox{\hyperlink{rebuild_parsers_8php_acf9b0a508729b11f65093e54c25c62aa}{\$resultDir}}\ .\ \textcolor{stringliteral}{'/Tokens.php'};}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00018}\mbox{\hyperlink{rebuild_parsers_8php_a3bcbef238ae7ed75f89567466ee4c005}{00018}}\ \mbox{\hyperlink{rebuild_parsers_8php_a3bcbef238ae7ed75f89567466ee4c005}{\$kmyacc}}\ =\ getenv(\textcolor{stringliteral}{'KMYACC'});}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00019}00019\ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{rebuild_parsers_8php_a3bcbef238ae7ed75f89567466ee4c005}{\$kmyacc}})\ \{}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00020}00020\ \ \ \ \ \textcolor{comment}{//\ Use\ phpyacc\ from\ dev\ dependencies\ by\ default.}}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00021}00021\ \ \ \ \ \mbox{\hyperlink{rebuild_parsers_8php_a3bcbef238ae7ed75f89567466ee4c005}{\$kmyacc}}\ =\ \_\_DIR\_\_\ .\ \textcolor{stringliteral}{'/../vendor/bin/phpyacc'};}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00022}00022\ \}}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00023}00023\ }
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00024}\mbox{\hyperlink{rebuild_parsers_8php_afccc0027dcfb3238aaffaebf99351b54}{00024}}\ \mbox{\hyperlink{rebuild_parsers_8php_afccc0027dcfb3238aaffaebf99351b54}{\$options}}\ =\ array\_flip(\mbox{\hyperlink{translation-status_8php_af4aba6237cb0d8d2720bc840728e1f3e}{\$argv}});}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00025}\mbox{\hyperlink{rebuild_parsers_8php_a04f0dc88e3d1ffaa9907b0b189aac208}{00025}}\ \mbox{\hyperlink{rebuild_parsers_8php_a04f0dc88e3d1ffaa9907b0b189aac208}{\$optionDebug}}\ =\ isset(\mbox{\hyperlink{rebuild_parsers_8php_afccc0027dcfb3238aaffaebf99351b54}{\$options}}[\textcolor{stringliteral}{'-\/-\/debug'}]);}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00026}\mbox{\hyperlink{rebuild_parsers_8php_ad2d5e1d85cadf957af699ffbaca1cb23}{00026}}\ \mbox{\hyperlink{rebuild_parsers_8php_ad2d5e1d85cadf957af699ffbaca1cb23}{\$optionKeepTmpGrammar}}\ =\ isset(\mbox{\hyperlink{rebuild_parsers_8php_afccc0027dcfb3238aaffaebf99351b54}{\$options}}[\textcolor{stringliteral}{'-\/-\/keep-\/tmp-\/grammar'}]);}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00027}00027\ }
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00031}00031\ }
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00032}\mbox{\hyperlink{rebuild_parsers_8php_a72ead29e4317fbc4335fd3ba764e8b59}{00032}}\ \mbox{\hyperlink{rebuild_parsers_8php_a72ead29e4317fbc4335fd3ba764e8b59}{\$tokens}}\ =\ file\_get\_contents(\mbox{\hyperlink{rebuild_parsers_8php_a9fd3574107f4ca3f912c817427e01b22}{\$tokensFile}});}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00033}00033\ }
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00034}00034\ \textcolor{keywordflow}{foreach}\ (\mbox{\hyperlink{rebuild_parsers_8php_a722f84b3733683c283f6e88bbffa7a5f}{\$grammarFileToName}}\ as\ \$grammarFile\ =>\ \$name)\ \{}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00035}00035\ \ \ \ \ echo\ \textcolor{stringliteral}{"{}Building\ temporary\ \$name\ grammar\ file.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00036}00036\ }
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00037}00037\ \ \ \ \ \$grammarCode\ =\ file\_get\_contents(\$grammarFile);}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00038}00038\ \ \ \ \ \$grammarCode\ =\ str\_replace(\textcolor{stringliteral}{'\%tokens'},\ \mbox{\hyperlink{rebuild_parsers_8php_a72ead29e4317fbc4335fd3ba764e8b59}{\$tokens}},\ \$grammarCode);}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00039}00039\ \ \ \ \ \$grammarCode\ =\ \mbox{\hyperlink{phpy_lang_8php_ad6230a667083e730f1578257b5daefa0}{preprocessGrammar}}(\$grammarCode);}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00040}00040\ }
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00041}00041\ \ \ \ \ file\_put\_contents(\mbox{\hyperlink{rebuild_parsers_8php_a4d8e050e3170aa76e75c3fbf86cd2131}{\$tmpGrammarFile}},\ \$grammarCode);}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00042}00042\ }
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00043}00043\ \ \ \ \ \$additionalArgs\ =\ \mbox{\hyperlink{rebuild_parsers_8php_a04f0dc88e3d1ffaa9907b0b189aac208}{\$optionDebug}}\ ?\ \textcolor{stringliteral}{'-\/t\ -\/v'}\ :\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00044}00044\ }
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00045}00045\ \ \ \ \ echo\ \textcolor{stringliteral}{"{}Building\ \$name\ parser.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00046}00046\ \ \ \ \ \$output\ =\ \mbox{\hyperlink{rebuild_parsers_8php_a0c4558ca021267c3b182374d4162a768}{execCmd}}(\textcolor{stringliteral}{"{}\$kmyacc\ \$additionalArgs\ -\/m\ \$skeletonFile\ -\/p\ \$name\ \$tmpGrammarFile"{}});}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00047}00047\ }
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00048}00048\ \ \ \ \ \$resultCode\ =\ file\_get\_contents(\mbox{\hyperlink{rebuild_parsers_8php_a5643cdc417b0bbcbeb029aea093166b2}{\$tmpResultFile}});}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00049}00049\ \ \ \ \ \$resultCode\ =\ \mbox{\hyperlink{phpy_lang_8php_a00e164ce988a8ca223ec64c386c49f56}{removeTrailingWhitespace}}(\$resultCode);}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00050}00050\ }
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00051}00051\ \ \ \ \ \mbox{\hyperlink{rebuild_parsers_8php_a31bb4367e1237f25d0ea7d4453c42387}{ensureDirExists}}(\mbox{\hyperlink{rebuild_parsers_8php_acf9b0a508729b11f65093e54c25c62aa}{\$resultDir}});}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00052}00052\ \ \ \ \ file\_put\_contents(\textcolor{stringliteral}{"{}\$resultDir/\$name.php"{}},\ \$resultCode);}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00053}00053\ \ \ \ \ unlink(\mbox{\hyperlink{rebuild_parsers_8php_a5643cdc417b0bbcbeb029aea093166b2}{\$tmpResultFile}});}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00054}00054\ }
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00055}00055\ \ \ \ \ echo\ \textcolor{stringliteral}{"{}Building\ token\ definition.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00056}00056\ \ \ \ \ \$output\ =\ \mbox{\hyperlink{rebuild_parsers_8php_a0c4558ca021267c3b182374d4162a768}{execCmd}}(\textcolor{stringliteral}{"{}\$kmyacc\ -\/m\ \$tokensTemplate\ \$tmpGrammarFile"{}});}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00057}00057\ \ \ \ \ rename(\mbox{\hyperlink{rebuild_parsers_8php_a5643cdc417b0bbcbeb029aea093166b2}{\$tmpResultFile}},\ \mbox{\hyperlink{rebuild_parsers_8php_a992c9e92e53a2c77e09c899dc1293f29}{\$tokensResultsFile}});}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00058}00058\ }
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00059}00059\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{rebuild_parsers_8php_ad2d5e1d85cadf957af699ffbaca1cb23}{\$optionKeepTmpGrammar}})\ \{}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00060}00060\ \ \ \ \ \ \ \ \ unlink(\mbox{\hyperlink{rebuild_parsers_8php_a4d8e050e3170aa76e75c3fbf86cd2131}{\$tmpGrammarFile}});}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00061}00061\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00062}00062\ \}}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00063}00063\ }
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00067}00067\ }
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00068}\mbox{\hyperlink{rebuild_parsers_8php_a31bb4367e1237f25d0ea7d4453c42387}{00068}}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{rebuild_parsers_8php_a31bb4367e1237f25d0ea7d4453c42387}{ensureDirExists}}(\$dir)\ \{}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00069}00069\ \ \ \ \ \textcolor{keywordflow}{if}\ (!is\_dir(\$dir))\ \{}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00070}00070\ \ \ \ \ \ \ \ \ mkdir(\$dir,\ 0777,\ \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00071}00071\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00072}00072\ \}}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00073}00073\ }
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00074}\mbox{\hyperlink{rebuild_parsers_8php_a0c4558ca021267c3b182374d4162a768}{00074}}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{rebuild_parsers_8php_a0c4558ca021267c3b182374d4162a768}{execCmd}}(\$cmd)\ \{}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00075}00075\ \ \ \ \ \$output\ =\ trim(shell\_exec(\textcolor{stringliteral}{"{}\$cmd\ 2>\&1"{}}));}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00076}00076\ \ \ \ \ \textcolor{keywordflow}{if}\ (\$output\ !==\ \textcolor{stringliteral}{"{}"{}})\ \{}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00077}00077\ \ \ \ \ \ \ \ \ echo\ \textcolor{stringliteral}{"{}>\ "{}}\ .\ \$cmd\ .\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00078}00078\ \ \ \ \ \ \ \ \ echo\ \$output;}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00079}00079\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00080}00080\ \ \ \ \ \textcolor{keywordflow}{return}\ \$output;}
\DoxyCodeLine{\Hypertarget{rebuild_parsers_8php_source_l00081}00081\ \}}

\end{DoxyCode}
