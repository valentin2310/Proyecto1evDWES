\doxysection{Libedit.\+php}
\hypertarget{_libedit_8php_source}{}\label{_libedit_8php_source}\index{vendor/psy/psysh/src/Readline/Libedit.php@{vendor/psy/psysh/src/Readline/Libedit.php}}
\mbox{\hyperlink{_libedit_8php}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00001}00001\ <?php}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00003}00003\ \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00004}00004\ \textcolor{comment}{\ *\ This\ file\ is\ part\ of\ Psy\ Shell.}}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00005}00005\ \textcolor{comment}{\ *}}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00006}00006\ \textcolor{comment}{\ *\ (c)\ 2012-\/2023\ Justin\ Hileman}}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00007}00007\ \textcolor{comment}{\ *}}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00008}00008\ \textcolor{comment}{\ *\ For\ the\ full\ copyright\ and\ license\ information,\ please\ view\ the\ LICENSE}}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00009}00009\ \textcolor{comment}{\ *\ file\ that\ was\ distributed\ with\ this\ source\ code.}}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00010}00010\ \textcolor{comment}{\ */}}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00011}00011\ }
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00012}00012\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_psy_1_1_readline}{Psy\(\backslash\)Readline}};}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00013}00013\ }
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00014}00014\ use\ \mbox{\hyperlink{class_psy_1_1_util_1_1_str}{Psy\(\backslash\)Util\(\backslash\)Str}};}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00015}00015\ }
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00026}\mbox{\hyperlink{class_psy_1_1_readline_1_1_libedit}{00026}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_psy_1_1_readline_1_1_libedit}{Libedit}}\ \textcolor{keyword}{extends}\ \mbox{\hyperlink{class_psy_1_1_readline_1_1_g_n_u_readline}{GNUReadline}}}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00027}00027\ \{}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00028}00028\ \ \ \ \ \textcolor{keyword}{private}\ \$hasWarnedOwnership\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00029}00029\ }
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00033}\mbox{\hyperlink{class_psy_1_1_readline_1_1_libedit_adc36dedf4b7b9d79eed5296b94001311}{00033}}\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{static}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{class_psy_1_1_readline_1_1_libedit_adc36dedf4b7b9d79eed5296b94001311}{isSupported}}():\ bool}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00034}00034\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00035}00035\ \ \ \ \ \ \ \ \ return\ \(\backslash\)function\_exists(\textcolor{stringliteral}{'readline'})\ \&\&\ !\(\backslash\)function\_exists(\textcolor{stringliteral}{'readline\_list\_history'});}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00036}00036\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00037}00037\ }
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00041}\mbox{\hyperlink{class_psy_1_1_readline_1_1_libedit_a2db39a08a7ec2607cdb11aa154423efa}{00041}}\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{static}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{class_psy_1_1_readline_1_1_libedit_a2db39a08a7ec2607cdb11aa154423efa}{supportsBracketedPaste}}():\ bool}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00042}00042\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00043}00043\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00044}00044\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00045}00045\ }
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00049}\mbox{\hyperlink{class_psy_1_1_readline_1_1_libedit_ad77b73fdd126631414eed766add8eb84}{00049}}\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{class_psy_1_1_readline_1_1_libedit_ad77b73fdd126631414eed766add8eb84}{listHistory}}():\ array}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00050}00050\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00051}00051\ \ \ \ \ \ \ \ \ \$history\ =\ \(\backslash\)file\_get\_contents(\$this-\/>historyFile);}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00052}00052\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$history)\ \{}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00053}00053\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [];}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00054}00054\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00055}00055\ }
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00056}00056\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ libedit\ doesn't\ seem\ to\ support\ non-\/unix\ line\ separators.}}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00057}00057\ \ \ \ \ \ \ \ \ \$history\ =\ \(\backslash\)explode(\textcolor{stringliteral}{"{}\(\backslash\)n"{}},\ \$history);}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00058}00058\ }
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00059}00059\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ remove\ history\ signature\ if\ it\ exists}}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00060}00060\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$history[0]\ ===\ \textcolor{stringliteral}{'\_HiStOrY\_V2\_'})\ \{}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00061}00061\ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)array\_shift(\$history);}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00062}00062\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00063}00063\ }
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00064}00064\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ decode\ the\ line}}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00065}00065\ \ \ \ \ \ \ \ \ \$history\ =\ \(\backslash\)array\_map([\$this,\ \textcolor{stringliteral}{'parseHistoryLine'}],\ \$history);}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00066}00066\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ filter\ empty\ lines\ \&\ comments}}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00067}00067\ \ \ \ \ \ \ \ \ return\ \(\backslash\)array\_values(\(\backslash\)array\_filter(\$history));}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00068}00068\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00069}00069\ }
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00073}\mbox{\hyperlink{class_psy_1_1_readline_1_1_libedit_a5e0c3a56eb7ee8d14f57df5eaf48c3d1}{00073}}\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{class_psy_1_1_readline_1_1_libedit_a5e0c3a56eb7ee8d14f57df5eaf48c3d1}{writeHistory}}():\ bool}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00074}00074\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00075}00075\ \ \ \ \ \ \ \ \ \$res\ =\ parent::writeHistory();}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00076}00076\ }
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00077}00077\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Libedit\ apparently\ refuses\ to\ save\ history\ if\ the\ history\ file\ is\ not}}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00078}00078\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ owned\ by\ the\ user,\ even\ if\ it\ is\ writable.\ Warn\ when\ this\ happens.}}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00079}00079\ \ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00080}00080\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ See\ https://github.com/bobthecow/psysh/issues/552}}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00081}00081\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$res\ ===\ \textcolor{keyword}{false}\ \&\&\ !\$this-\/>hasWarnedOwnership)\ \{}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00082}00082\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\(\backslash\)is\_file(\$this-\/>historyFile)\ \&\&\ \(\backslash\)is\_writable(\$this-\/>historyFile))\ \{}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00083}00083\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>hasWarnedOwnership\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00084}00084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$msg\ =\ \(\backslash\)sprintf(\textcolor{stringliteral}{'Error\ writing\ history\ file,\ check\ file\ ownership:\ \%s'},\ \$this-\/>historyFile);}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00085}00085\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)trigger\_error(\$msg,\ \(\backslash\)E\_USER\_NOTICE);}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00086}00086\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00087}00087\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00088}00088\ }
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00089}00089\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$res;}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00090}00090\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00091}00091\ }
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00102}\mbox{\hyperlink{class_psy_1_1_readline_1_1_libedit_a414979b332751f6042b3184980ad248b}{00102}}\ \ \ \ \ \textcolor{keyword}{protected}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{class_psy_1_1_readline_1_1_libedit_a414979b332751f6042b3184980ad248b}{parseHistoryLine}}(\textcolor{keywordtype}{string}\ \$line)}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00103}00103\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00104}00104\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ empty\ line,\ comment\ or\ timestamp}}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00105}00105\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$line\ ||\ \$line[0]\ ===\ \textcolor{stringliteral}{"{}\(\backslash\)0"{}})\ \{}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00106}00106\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00107}00107\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00108}00108\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ "{}\(\backslash\)0"{}\ is\ found\ in\ an\ entry,\ then}}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00109}00109\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ everything\ from\ it\ until\ the\ end\ of\ line\ is\ a\ comment.}}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00110}00110\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\$pos\ =\ \(\backslash\)strpos(\$line,\ \textcolor{stringliteral}{"{}\(\backslash\)0"{}}))\ !==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00111}00111\ \ \ \ \ \ \ \ \ \ \ \ \ \$line\ =\ \(\backslash\)substr(\$line,\ 0,\ \$pos);}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00112}00112\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00113}00113\ }
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00114}00114\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\$line\ !==\ \textcolor{stringliteral}{''})\ ?\ \mbox{\hyperlink{class_psy_1_1_util_1_1_str_aa19bf82b26c436905a0f1d2714b0a44b}{Str::unvis}}(\$line)\ :\ \textcolor{keyword}{null};}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00115}00115\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_libedit_8php_source_l00116}00116\ \}}

\end{DoxyCode}
